<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdSpy Tool - Architecture & Implementation Journey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e4e4e4;
            line-height: 1.6;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }
        .version-badge {
            display: inline-block;
            background: #00ff88;
            color: #1a1a2e;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        h2 {
            color: #00d9ff;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        h3 {
            color: #00ff88;
            margin: 20px 0 10px 0;
            font-size: 1.2rem;
        }
        .diagram {
            background: #0d1117;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            overflow-x: auto;
            border: 1px solid #30363d;
        }
        .diagram pre {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            line-height: 1.5;
            color: #c9d1d9;
        }
        .flow-diagram {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .flow-box {
            background: linear-gradient(135deg, #1e3a5f, #2d5a87);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            min-width: 180px;
            border: 2px solid #3d7ab8;
            transition: transform 0.2s;
        }
        .flow-box:hover {
            transform: translateY(-5px);
        }
        .flow-box.success {
            border-color: #00ff88;
            background: linear-gradient(135deg, #1a3d2e, #2d5a4a);
        }
        .flow-box.fail {
            border-color: #ff4757;
            background: linear-gradient(135deg, #3d1a1a, #5a2d2d);
        }
        .flow-box h4 {
            font-size: 1rem;
            margin-bottom: 8px;
        }
        .flow-box p {
            font-size: 0.85rem;
            color: #aaa;
        }
        .arrow {
            font-size: 2rem;
            color: #00d9ff;
        }
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #ff4757, #ffa502, #00ff88);
            border-radius: 3px;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding-left: 20px;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -36px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00d9ff;
            border: 3px solid #1a1a2e;
        }
        .timeline-item.fail::before {
            background: #ff4757;
        }
        .timeline-item.success::before {
            background: #00ff88;
        }
        .version-tag {
            display: inline-block;
            background: rgba(0, 217, 255, 0.2);
            color: #00d9ff;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            margin-right: 10px;
        }
        .status-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
        }
        .status-tag.fail {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }
        .status-tag.success {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        th {
            background: rgba(0, 217, 255, 0.1);
            color: #00d9ff;
            font-weight: 600;
        }
        tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }
        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
            color: #00ff88;
        }
        .code-block {
            background: #0d1117;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid #30363d;
        }
        .code-block code {
            background: none;
            padding: 0;
            display: block;
            white-space: pre;
            color: #c9d1d9;
        }
        .highlight {
            color: #00ff88;
        }
        .comment {
            color: #6a737d;
        }
        .string {
            color: #a5d6ff;
        }
        .keyword {
            color: #ff7b72;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .card h4 {
            color: #00d9ff;
            margin-bottom: 10px;
        }
        .metric {
            font-size: 2rem;
            font-weight: bold;
            color: #00ff88;
        }
        .metric-label {
            color: #888;
            font-size: 0.9rem;
        }
        .api-endpoint {
            background: #0d1117;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #00d9ff;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            margin-right: 10px;
        }
        .method.get {
            background: #238636;
            color: white;
        }
        .method.post {
            background: #1f6feb;
            color: white;
        }
        .env-var {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            margin: 8px 0;
        }
        .env-var .key {
            color: #00d9ff;
            font-family: monospace;
        }
        .env-var .value {
            color: #888;
            font-family: monospace;
        }
        .feature-list {
            list-style: none;
        }
        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .feature-list li::before {
            content: 'âœ“';
            color: #00ff88;
            font-weight: bold;
        }
        .architecture-svg {
            width: 100%;
            max-width: 900px;
            margin: 20px auto;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” AdSpy Tool</h1>
        <p class="subtitle">Architecture & Implementation Journey <span class="version-badge">v4.3.0</span></p>

        <!-- Overview Section -->
        <section>
            <h2>ğŸ“‹ Overview</h2>
            <p>AdSpy is a competitive intelligence tool that searches Google for sponsored ads, extracts advertiser data, captures screenshots of landing pages, and provides AI-powered analysis of competitor ad strategies.</p>

            <div class="grid-2" style="margin-top: 20px;">
                <div class="card">
                    <h4>What It Does</h4>
                    <ul class="feature-list">
                        <li>Searches Google for sponsored ads by keyword</li>
                        <li>Extracts ad titles, descriptions, URLs, sitelinks</li>
                        <li>Captures SERP screenshots</li>
                        <li>Captures landing page screenshots</li>
                        <li>Fetches ad creative images from Transparency Center</li>
                        <li>Paginates through pages 1-3 for more advertisers</li>
                        <li>AI analysis of competitor ad strategies</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Final Test Results</h4>
                    <div class="metric">12</div>
                    <div class="metric-label">Unique ads found (3 pages)</div>
                    <br>
                    <div class="metric">100%</div>
                    <div class="metric-label">Landing page screenshot success rate</div>
                    <br>
                    <div class="metric">3</div>
                    <div class="metric-label">Google pages scraped</div>
                </div>
            </div>
        </section>

        <!-- Final Architecture -->
        <section>
            <h2>ğŸ—ï¸ Final Architecture (v4.3)</h2>

            <div class="diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ADSPY ARCHITECTURE v4.3                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   KADABRA    â”‚     â”‚   Next.js API    â”‚     â”‚      Python Service (Railway)   â”‚
â”‚   Frontend   â”‚â”€â”€â”€â”€â–¶â”‚   /api/adspy/*   â”‚â”€â”€â”€â”€â–¶â”‚   adspy-production.up.railway   â”‚
â”‚              â”‚     â”‚                  â”‚     â”‚                                 â”‚
â”‚  - Search UI â”‚     â”‚  - /search       â”‚     â”‚   FastAPI + Playwright          â”‚
â”‚  - Results   â”‚     â”‚  - /analyze      â”‚     â”‚                                 â”‚
â”‚  - Analysis  â”‚     â”‚  - /jobs         â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                                              â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                                        â”‚                â”‚
                     â–¼                                        â–¼                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Bright Data Browser   â”‚         â”‚  SerpApi Ads        â”‚  â”‚ Regular Playwrightâ”‚
        â”‚  API (WebSocket)       â”‚         â”‚  Transparency       â”‚  â”‚ (on Railway)      â”‚
        â”‚                        â”‚         â”‚  Center             â”‚  â”‚                   â”‚
        â”‚  - Bypass Google bot   â”‚         â”‚                     â”‚  â”‚  - Landing page   â”‚
        â”‚    detection           â”‚         â”‚  - Ad creative      â”‚  â”‚    screenshots    â”‚
        â”‚  - SERP screenshot     â”‚         â”‚    images           â”‚  â”‚  - No robots.txt  â”‚
        â”‚  - Extract ad HTML     â”‚         â”‚  - Advertiser info  â”‚  â”‚    restrictions   â”‚
        â”‚  - Pages 1, 2, 3       â”‚         â”‚  - All creatives    â”‚  â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                                â”‚                       â”‚
                     â”‚                                â”‚                       â”‚
                     â–¼                                â–¼                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ SERP Data   â”‚              â”‚ Ad Creative     â”‚      â”‚ Landing Page    â”‚
              â”‚ + Screenshotâ”‚              â”‚ Images          â”‚      â”‚ Screenshots     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                                â”‚                       â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                      â”‚
                                                      â–¼
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚   Combined Response â”‚
                                          â”‚                     â”‚
                                          â”‚  - ads[]            â”‚
                                          â”‚  - serp_screenshot  â”‚
                                          â”‚  - ad_creative_imageâ”‚
                                          â”‚  - landing_screenshotâ”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Data Flow</h3>
            <div class="flow-diagram">
                <div class="flow-box">
                    <h4>1. User Search</h4>
                    <p>Keyword + Location</p>
                </div>
                <span class="arrow">â†’</span>
                <div class="flow-box">
                    <h4>2. Bright Data</h4>
                    <p>Google SERP (3 pages)</p>
                </div>
                <span class="arrow">â†’</span>
                <div class="flow-box">
                    <h4>3. Extract Ads</h4>
                    <p>Parse HTML DOM</p>
                </div>
                <span class="arrow">â†’</span>
                <div class="flow-box">
                    <h4>4. SerpApi</h4>
                    <p>Ad Creatives</p>
                </div>
                <span class="arrow">â†’</span>
                <div class="flow-box">
                    <h4>5. Playwright</h4>
                    <p>Landing Screenshots</p>
                </div>
                <span class="arrow">â†’</span>
                <div class="flow-box success">
                    <h4>6. Response</h4>
                    <p>Complete Data</p>
                </div>
            </div>
        </section>

        <!-- Implementation Journey -->
        <section>
            <h2>ğŸ›¤ï¸ Implementation Journey</h2>
            <p>The path to a working solution involved multiple iterations and problem-solving:</p>

            <div class="timeline">
                <div class="timeline-item fail">
                    <span class="version-tag">v2.1</span>
                    <span class="status-tag fail">BLOCKED</span>
                    <h4>Regular Playwright on Railway</h4>
                    <p>Attempted to scrape Google directly with stealth mode. Railway's IP was blocked by Google with CAPTCHA challenges.</p>
                </div>

                <div class="timeline-item fail">
                    <span class="version-tag">v2.2</span>
                    <span class="status-tag fail">BLOCKED</span>
                    <h4>Bright Data Residential Proxy</h4>
                    <p>Added residential proxy support. Google access was blocked - "immediate access mode doesn't allow Google".</p>
                </div>

                <div class="timeline-item fail">
                    <span class="version-tag">v3.0</span>
                    <span class="status-tag fail">NO ADS</span>
                    <h4>Bright Data Web Unlocker</h4>
                    <p>Got 465KB of HTML but no ads found. Ads are loaded via JavaScript - Web Unlocker doesn't render JS.</p>
                </div>

                <div class="timeline-item fail">
                    <span class="version-tag">v3.1</span>
                    <span class="status-tag fail">NO ADS</span>
                    <h4>Web Unlocker with brd_json=1</h4>
                    <p>Used JSON parsing mode. Got structured data but <code>top_ads: None</code> - the zone can't extract paid ad content.</p>
                </div>

                <div class="timeline-item fail">
                    <span class="version-tag">-</span>
                    <span class="status-tag fail">NO ADS</span>
                    <h4>Bright Data SERP API Zone</h4>
                    <p>Created dedicated SERP zone. Still returned <code>top_ads: None</code>.</p>
                </div>

                <div class="timeline-item success">
                    <span class="version-tag">v4.0</span>
                    <span class="status-tag success">SUCCESS</span>
                    <h4>Bright Data Browser API + Playwright</h4>
                    <p>Connected Playwright to Bright Data's remote browser via WebSocket. Full JavaScript rendering - found 6-7 ads with all data!</p>
                </div>

                <div class="timeline-item fail">
                    <span class="version-tag">v4.0</span>
                    <span class="status-tag fail">BLOCKED</span>
                    <h4>Landing Screenshots via Bright Data</h4>
                    <p>Attempted to screenshot landing pages through Bright Data. Blocked by robots.txt restrictions on GEICO, Progressive, etc.</p>
                </div>

                <div class="timeline-item success">
                    <span class="version-tag">v4.1</span>
                    <span class="status-tag success">SUCCESS</span>
                    <h4>SerpApi Ads Transparency Center</h4>
                    <p>Added SerpApi integration to fetch ad creative images from Google's Transparency Center.</p>
                </div>

                <div class="timeline-item success">
                    <span class="version-tag">v4.2</span>
                    <span class="status-tag success">SUCCESS</span>
                    <h4>Regular Playwright for Landing Pages</h4>
                    <p>Used regular Playwright (not proxied) for landing page screenshots. No robots.txt blocks!</p>
                </div>

                <div class="timeline-item success">
                    <span class="version-tag">v4.3</span>
                    <span class="status-tag success">FINAL</span>
                    <h4>Multi-Page Pagination</h4>
                    <p>Added pagination through Google pages 1, 2, and 3 to find more unique advertisers. 12 ads found!</p>
                </div>
            </div>
        </section>

        <!-- Key Insights -->
        <section>
            <h2>ğŸ’¡ Key Insights & Solutions</h2>

            <div class="grid-2">
                <div class="card">
                    <h4>Problem: Google Bot Detection</h4>
                    <p><strong>Symptom:</strong> CAPTCHA challenges, blocked requests</p>
                    <p><strong>Solution:</strong> Bright Data Browser API provides a remote browser that mimics real user behavior with residential IPs.</p>
                </div>

                <div class="card">
                    <h4>Problem: JavaScript-Rendered Ads</h4>
                    <p><strong>Symptom:</strong> HTML returned but no ads in DOM</p>
                    <p><strong>Solution:</strong> Browser API renders full JavaScript. Used <code>[data-text-ad="1"]</code> selector to find ads.</p>
                </div>

                <div class="card">
                    <h4>Problem: Landing Page robots.txt</h4>
                    <p><strong>Symptom:</strong> "Requested URL restricted in accordance with robots.txt"</p>
                    <p><strong>Solution:</strong> Use regular Playwright (not proxied) for landing pages. Sites only block proxy IPs.</p>
                </div>

                <div class="card">
                    <h4>Problem: Limited Advertisers</h4>
                    <p><strong>Symptom:</strong> Only 5-6 ads from page 1</p>
                    <p><strong>Solution:</strong> Paginate through pages 1-3 with <code>&start=</code> parameter. Track seen titles to avoid duplicates.</p>
                </div>
            </div>
        </section>

        <!-- Technical Details -->
        <section>
            <h2>âš™ï¸ Technical Details</h2>

            <h3>API Endpoints</h3>
            <div class="api-endpoint">
                <span class="method get">GET</span>
                <code>/health</code>
                <p style="margin-top: 8px; color: #888;">Health check endpoint for Railway deployment monitoring</p>
            </div>
            <div class="api-endpoint">
                <span class="method post">POST</span>
                <code>/search</code>
                <p style="margin-top: 8px; color: #888;">Main search endpoint - returns ads, screenshots, and metadata</p>
            </div>

            <h3>Request Schema</h3>
            <div class="code-block">
<code>{
  <span class="string">"api_key"</span>: <span class="string">"adspy-magi-secret-2024"</span>,
  <span class="string">"keyword"</span>: <span class="string">"car insurance quotes"</span>,
  <span class="string">"location"</span>: <span class="string">"us"</span>,
  <span class="string">"num_results"</span>: <span class="highlight">20</span>
}</code>
            </div>

            <h3>Response Schema</h3>
            <div class="code-block">
<code>{
  <span class="string">"success"</span>: <span class="keyword">true</span>,
  <span class="string">"keyword"</span>: <span class="string">"car insurance quotes"</span>,
  <span class="string">"ads"</span>: [
    {
      <span class="string">"position"</span>: <span class="highlight">1</span>,
      <span class="string">"block_position"</span>: <span class="string">"top"</span>,
      <span class="string">"source_page"</span>: <span class="highlight">1</span>,
      <span class="string">"title"</span>: <span class="string">"GEICOÂ® Official Site..."</span>,
      <span class="string">"description"</span>: <span class="string">"Compare Rates..."</span>,
      <span class="string">"link"</span>: <span class="string">"https://www.geico.com/..."</span>,
      <span class="string">"displayed_link"</span>: <span class="string">"www.geico.com"</span>,
      <span class="string">"sitelinks"</span>: [...],
      <span class="string">"advertiser_name"</span>: <span class="string">"GEICO Corporation"</span>,
      <span class="string">"advertiser_id"</span>: <span class="string">"AR14408770578271961089"</span>,
      <span class="string">"ad_creative_image"</span>: <span class="string">"https://tpc.googlesyndication.com/..."</span>,
      <span class="string">"all_creatives"</span>: [...],
      <span class="string">"landing_page_screenshot_base64"</span>: <span class="string">"base64..."</span>
    }
  ],
  <span class="string">"serp_screenshot"</span>: <span class="string">"base64..."</span>,
  <span class="string">"debug_info"</span>: {
    <span class="string">"pages_scraped"</span>: <span class="highlight">3</span>,
    <span class="string">"ads_per_page"</span>: [<span class="highlight">6</span>, <span class="highlight">3</span>, <span class="highlight">3</span>],
    <span class="string">"landing_screenshots_captured"</span>: <span class="highlight">12</span>
  }
}</code>
            </div>

            <h3>Environment Variables</h3>
            <div class="env-var">
                <span class="key">ADSPY_API_KEY</span>
                <span class="value">Internal API authentication</span>
            </div>
            <div class="env-var">
                <span class="key">BRIGHTDATA_BROWSER_WS</span>
                <span class="value">WebSocket endpoint for Browser API</span>
            </div>
            <div class="env-var">
                <span class="key">SERPAPI_KEY</span>
                <span class="value">SerpApi key for Transparency Center</span>
            </div>

            <h3>Dependencies</h3>
            <div class="code-block">
<code><span class="comment"># requirements.txt</span>
fastapi==0.115.6
uvicorn[standard]==0.34.0
playwright==1.49.1
pydantic>=2.0.0
httpx>=0.25.0
beautifulsoup4>=4.12.0</code>
            </div>
        </section>

        <!-- Services Used -->
        <section>
            <h2>ğŸ”§ External Services</h2>

            <table>
                <thead>
                    <tr>
                        <th>Service</th>
                        <th>Purpose</th>
                        <th>Why Needed</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Bright Data Browser API</strong></td>
                        <td>Google SERP scraping</td>
                        <td>Bypasses Google's bot detection with real browser + residential IPs</td>
                    </tr>
                    <tr>
                        <td><strong>SerpApi Ads Transparency Center</strong></td>
                        <td>Ad creative images</td>
                        <td>Gets official screenshots of ads from Google's Transparency Center</td>
                    </tr>
                    <tr>
                        <td><strong>Railway</strong></td>
                        <td>Python service hosting</td>
                        <td>Runs FastAPI + Playwright with auto-deploy from GitHub</td>
                    </tr>
                    <tr>
                        <td><strong>Vercel</strong></td>
                        <td>KADABRA hosting</td>
                        <td>Next.js frontend and API routes</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- DOM Selectors -->
        <section>
            <h2>ğŸ¯ Google Ad DOM Selectors</h2>
            <p>Key selectors discovered for extracting Google sponsored ads:</p>

            <table>
                <thead>
                    <tr>
                        <th>Selector</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>[data-text-ad="1"]</code></td>
                        <td>Main sponsored text ad elements</td>
                    </tr>
                    <tr>
                        <td><code>#tads</code></td>
                        <td>Top ads container</td>
                    </tr>
                    <tr>
                        <td><code>#tadsb</code></td>
                        <td>Bottom ads container</td>
                    </tr>
                    <tr>
                        <td><code>div[role="heading"]</code></td>
                        <td>Ad title/headline</td>
                    </tr>
                    <tr>
                        <td><code>cite</code></td>
                        <td>Displayed URL</td>
                    </tr>
                    <tr>
                        <td><code>a[data-rw]</code></td>
                        <td>Main destination link</td>
                    </tr>
                    <tr>
                        <td><code>a[data-impdclcc]</code></td>
                        <td>Sitelink elements</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- What Didn't Work -->
        <section>
            <h2>âŒ Approaches That Failed</h2>

            <table>
                <thead>
                    <tr>
                        <th>Approach</th>
                        <th>Issue</th>
                        <th>Lesson</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Direct Playwright on Railway</td>
                        <td>Google CAPTCHA/blocks</td>
                        <td>Cloud IPs are flagged for scraping</td>
                    </tr>
                    <tr>
                        <td>Bright Data Residential Proxy</td>
                        <td>Google access denied</td>
                        <td>"Immediate access" mode restricts Google</td>
                    </tr>
                    <tr>
                        <td>Bright Data Web Unlocker</td>
                        <td>No ads in response</td>
                        <td>Doesn't render JavaScript</td>
                    </tr>
                    <tr>
                        <td>Web Unlocker brd_json=1</td>
                        <td>top_ads: None</td>
                        <td>Zone can detect but not extract paid ads</td>
                    </tr>
                    <tr>
                        <td>SERP API Zone</td>
                        <td>top_ads: None</td>
                        <td>Same limitation as Web Unlocker</td>
                    </tr>
                    <tr>
                        <td>SerpApi Google Search</td>
                        <td>No ads returned</td>
                        <td>SerpApi doesn't always capture Google Ads</td>
                    </tr>
                    <tr>
                        <td>Landing screenshots via Bright Data</td>
                        <td>robots.txt blocked</td>
                        <td>Advertiser sites block proxy IPs</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Final Solution -->
        <section>
            <h2>âœ… Final Working Solution</h2>

            <div class="diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         HYBRID APPROACH                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  BRIGHT DATA        â”‚     â”‚  REGULAR PLAYWRIGHT                 â”‚  â”‚
â”‚  â”‚  Browser API        â”‚     â”‚  (on Railway)                       â”‚  â”‚
â”‚  â”‚                     â”‚     â”‚                                     â”‚  â”‚
â”‚  â”‚  âœ“ Google SERP      â”‚     â”‚  âœ“ Landing page screenshots         â”‚  â”‚
â”‚  â”‚  âœ“ JavaScript       â”‚     â”‚  âœ“ No proxy = No robots.txt blocks  â”‚  â”‚
â”‚  â”‚  âœ“ Bot bypass       â”‚     â”‚  âœ“ Normal browser behavior          â”‚  â”‚
â”‚  â”‚  âœ“ Pages 1-3        â”‚     â”‚                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â”‚                               â”‚                           â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                            â”‚                                           â”‚
â”‚                            â–¼                                           â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚              â”‚  SERPAPI                â”‚                               â”‚
â”‚              â”‚  Ads Transparency Centerâ”‚                               â”‚
â”‚              â”‚                         â”‚                               â”‚
â”‚              â”‚  âœ“ Ad creative images   â”‚                               â”‚
â”‚              â”‚  âœ“ Advertiser info      â”‚                               â”‚
â”‚              â”‚  âœ“ All ad variations    â”‚                               â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Insight: Use the RIGHT tool for each task
- Proxied browser for Google (needs bot bypass)
- Regular browser for landing pages (needs clean IP)
- API for structured data (Transparency Center)
</pre>
            </div>
        </section>

        <!-- Footer -->
        <section style="text-align: center; background: transparent; border: none;">
            <p style="color: #666;">
                Built for MagiManager Â· KADABRA Ads Console<br>
                <span class="version-badge">AdSpy v4.3.0</span>
            </p>
        </section>
    </div>
</body>
</html>
