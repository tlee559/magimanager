<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Downloader Architecture - MagiManager</title>
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --border-color: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 1.75rem;
            margin: 2rem 0 1rem;
            color: var(--accent-blue);
            border-bottom: 2px solid var(--bg-tertiary);
            padding-bottom: 0.5rem;
        }

        h3 {
            font-size: 1.25rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--accent-purple);
        }

        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--bg-tertiary);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-blue { background: rgba(59, 130, 246, 0.2); color: var(--accent-blue); }
        .badge-purple { background: rgba(139, 92, 246, 0.2); color: var(--accent-purple); }
        .badge-green { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }
        .badge-orange { background: rgba(245, 158, 11, 0.2); color: var(--accent-orange); }

        code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9rem;
        }

        pre {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
        }

        /* Architecture Diagram */
        .diagram {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 1px solid var(--bg-tertiary);
            overflow-x: auto;
        }

        .diagram-title {
            text-align: center;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
        }

        .flow-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
        }

        .flow-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .flow-box {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem 1.5rem;
            text-align: center;
            min-width: 150px;
            position: relative;
        }

        .flow-box.user { border-color: var(--accent-green); }
        .flow-box.frontend { border-color: var(--accent-blue); }
        .flow-box.api { border-color: var(--accent-purple); }
        .flow-box.python { border-color: var(--accent-orange); }
        .flow-box.storage { border-color: var(--accent-red); }
        .flow-box.external { border-color: #64748b; }

        .flow-box-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.25rem;
        }

        .flow-box.user .flow-box-label { color: var(--accent-green); }
        .flow-box.frontend .flow-box-label { color: var(--accent-blue); }
        .flow-box.api .flow-box-label { color: var(--accent-purple); }
        .flow-box.python .flow-box-label { color: var(--accent-orange); }
        .flow-box.storage .flow-box-label { color: var(--accent-red); }
        .flow-box.external .flow-box-label { color: #64748b; }

        .flow-box-title {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .flow-arrow {
            font-size: 1.5rem;
            color: var(--text-secondary);
        }

        .flow-arrow-down {
            font-size: 2rem;
            color: var(--text-secondary);
        }

        .flow-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: var(--bg-primary);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            margin: 0 0.5rem;
        }

        /* Sequence Diagram */
        .sequence-diagram {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
        }

        .sequence-row {
            display: grid;
            grid-template-columns: 100px 1fr 100px;
            gap: 1rem;
            align-items: center;
            padding: 0.5rem;
            border-radius: 4px;
        }

        .sequence-row:nth-child(odd) {
            background: rgba(255, 255, 255, 0.02);
        }

        .sequence-actor {
            text-align: center;
            font-weight: 600;
            color: var(--text-primary);
        }

        .sequence-message {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sequence-arrow {
            flex: 1;
            height: 2px;
            background: var(--accent-blue);
            position: relative;
        }

        .sequence-arrow.reverse {
            background: var(--accent-green);
        }

        .sequence-arrow::after {
            content: 'â–¶';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-blue);
            font-size: 0.6rem;
        }

        .sequence-arrow.reverse::after {
            content: 'â—€';
            left: -8px;
            right: auto;
            color: var(--accent-green);
        }

        .sequence-text {
            font-size: 0.75rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        /* File Tree */
        .file-tree {
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            line-height: 1.8;
        }

        .file-tree-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0;
        }

        .file-tree-item.folder { color: var(--accent-blue); }
        .file-tree-item.file { color: var(--text-secondary); }
        .file-tree-item.important { color: var(--accent-green); font-weight: 600; }

        .indent-1 { margin-left: 1rem; }
        .indent-2 { margin-left: 2rem; }
        .indent-3 { margin-left: 3rem; }
        .indent-4 { margin-left: 4rem; }

        /* Problem/Solution boxes */
        .problem-box {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--accent-red);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .solution-box {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--accent-green);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .problem-box h4, .solution-box h4 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .problem-box h4 { color: var(--accent-red); }
        .solution-box h4 { color: var(--accent-green); }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-primary);
        }

        td {
            color: var(--text-secondary);
        }

        /* Step list */
        .steps {
            counter-reset: step-counter;
            list-style: none;
            padding: 0;
        }

        .steps li {
            counter-increment: step-counter;
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--bg-tertiary);
        }

        .steps li::before {
            content: counter(step-counter);
            background: var(--accent-purple);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .step-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--bg-tertiary);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 1.5rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -2rem;
            top: 0.25rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-purple);
            border: 2px solid var(--bg-primary);
        }

        .timeline-item.success::before { background: var(--accent-green); }
        .timeline-item.error::before { background: var(--accent-red); }
        .timeline-item.warning::before { background: var(--accent-orange); }

        .timeline-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .timeline-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* Grid layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        /* Status indicator */
        .status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.green { background: var(--accent-green); }
        .status-dot.red { background: var(--accent-red); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* TOC */
        .toc {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--bg-tertiary);
        }

        .toc-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .toc-list {
            list-style: none;
            padding: 0;
        }

        .toc-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .toc-list li:last-child {
            border-bottom: none;
        }

        .toc-list a {
            color: var(--accent-blue);
            text-decoration: none;
        }

        .toc-list a:hover {
            text-decoration: underline;
        }

        /* Footer */
        footer {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--bg-tertiary);
            text-align: center;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ YouTube Downloader Architecture</h1>
        <p class="subtitle">Technical documentation for MagiManager's YouTube video download system</p>

        <div class="card">
            <div class="status">
                <span class="status-dot green"></span>
                <span style="color: var(--accent-green); font-weight: 600;">System Status: Operational</span>
            </div>
            <p style="margin-top: 0.5rem; margin-bottom: 0;">
                Last updated: December 2024 | Railway Python Service + Vercel Next.js + Vercel Blob Storage
            </p>
        </div>

        <!-- Table of Contents -->
        <div class="toc">
            <div class="toc-title">ğŸ“‘ Table of Contents</div>
            <ul class="toc-list">
                <li><a href="#overview">1. System Overview</a></li>
                <li><a href="#problem">2. The Problem We Solved</a></li>
                <li><a href="#architecture">3. Architecture Diagram</a></li>
                <li><a href="#flow">4. Data Flow & Sequence</a></li>
                <li><a href="#components">5. Component Breakdown</a></li>
                <li><a href="#files">6. File Structure</a></li>
                <li><a href="#api">7. API Endpoints</a></li>
                <li><a href="#integration">8. Video Clipper Integration</a></li>
                <li><a href="#deployment">9. Deployment Guide</a></li>
            </ul>
        </div>

        <!-- Section 1: Overview -->
        <h2 id="overview">1. System Overview</h2>
        <p>
            MagiManager's YouTube Downloader allows users to download YouTube videos and store them in cloud storage.
            The system consists of three main parts working together:
        </p>

        <div class="grid-2">
            <div class="card">
                <div class="card-title">
                    <span class="badge badge-blue">Frontend</span>
                    KADABRA App
                </div>
                <p>Next.js application hosted on Vercel. Provides the user interface for pasting YouTube URLs and viewing download progress.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    <span class="badge badge-purple">Backend</span>
                    Vercel API Routes
                </div>
                <p>Serverless functions that orchestrate the download process, manage job status, and upload to blob storage.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    <span class="badge badge-orange">Python Service</span>
                    Railway
                </div>
                <p>FastAPI server running yt-dlp. Has a good IP reputation and can download from YouTube without being blocked.</p>
            </div>

            <div class="card">
                <div class="card-title">
                    <span class="badge badge-green">Storage</span>
                    Vercel Blob
                </div>
                <p>Cloud storage for downloaded videos. Provides public URLs for playback and download.</p>
            </div>
        </div>

        <!-- Section 2: The Problem -->
        <h2 id="problem">2. The Problem We Solved</h2>

        <div class="problem-box">
            <h4>âŒ The Problem</h4>
            <p>
                <strong>YouTube blocks serverless IP addresses.</strong> When trying to download YouTube videos directly
                from Vercel's serverless functions, YouTube returns errors like "Sign in to confirm you're not a bot"
                or rate limits the requests. This is because:
            </p>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: var(--text-secondary);">
                <li>Vercel uses shared IP pools that YouTube has flagged</li>
                <li>Serverless functions have ephemeral IPs that look suspicious</li>
                <li>High request volumes from cloud providers trigger bot detection</li>
            </ul>
        </div>

        <div class="solution-box">
            <h4>âœ… The Solution</h4>
            <p>
                <strong>Use a dedicated server with good IP reputation.</strong> We deployed a Python service on Railway
                that acts as a proxy for YouTube downloads:
            </p>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem; color: var(--text-secondary);">
                <li>Railway provides dedicated IPs that aren't flagged by YouTube</li>
                <li>The Python service uses yt-dlp, the most reliable YouTube downloader</li>
                <li>Vercel calls Railway â†’ Railway downloads from YouTube â†’ Returns video to Vercel</li>
                <li>Vercel then stores the video in Blob storage for permanent access</li>
            </ul>
        </div>

        <!-- Section 3: Architecture Diagram -->
        <h2 id="architecture">3. Architecture Diagram</h2>

        <div class="diagram">
            <div class="diagram-title">High-Level System Architecture</div>
            <div class="flow-container">
                <!-- Row 1: User -->
                <div class="flow-row">
                    <div class="flow-box user">
                        <div class="flow-box-label">User</div>
                        <div class="flow-box-title">ğŸ‘¤ Browser</div>
                    </div>
                </div>

                <div class="flow-arrow-down">â†“</div>

                <!-- Row 2: Frontend -->
                <div class="flow-row">
                    <div class="flow-box frontend">
                        <div class="flow-box-label">Frontend</div>
                        <div class="flow-box-title">ğŸ“± KADABRA UI</div>
                    </div>
                    <span class="flow-label">magimanager.com</span>
                </div>

                <div class="flow-arrow-down">â†“</div>

                <!-- Row 3: API -->
                <div class="flow-row">
                    <div class="flow-box api">
                        <div class="flow-box-label">API Route</div>
                        <div class="flow-box-title">âš¡ Vercel Function</div>
                    </div>
                    <span class="flow-label">/api/youtube-scraper/*</span>
                </div>

                <div class="flow-arrow-down">â†“</div>

                <!-- Row 4: Python + YouTube -->
                <div class="flow-row">
                    <div class="flow-box python">
                        <div class="flow-box-label">Python Service</div>
                        <div class="flow-box-title">ğŸ Railway (yt-dlp)</div>
                    </div>
                    <span class="flow-arrow">â†’</span>
                    <div class="flow-box external">
                        <div class="flow-box-label">External</div>
                        <div class="flow-box-title">ğŸ“º YouTube</div>
                    </div>
                </div>

                <div class="flow-arrow-down">â†“</div>

                <!-- Row 5: Storage -->
                <div class="flow-row">
                    <div class="flow-box storage">
                        <div class="flow-box-label">Storage</div>
                        <div class="flow-box-title">ğŸ’¾ Vercel Blob</div>
                    </div>
                    <span class="flow-label">Permanent video storage</span>
                </div>
            </div>
        </div>

        <!-- Detailed Component Diagram -->
        <div class="diagram">
            <div class="diagram-title">Detailed Component Interaction</div>
            <pre style="background: transparent; border: none; text-align: center; color: var(--text-secondary);">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    VERCEL                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           KADABRA (Next.js)                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  YouTube Scraper   â”‚    â”‚           API Routes                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  View Component    â”‚â”€â”€â”€â–¶â”‚  /api/youtube-scraper/info    (POST)    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                    â”‚    â”‚  /api/youtube-scraper/download (POST)    â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - URL Input       â”‚    â”‚  /api/youtube-scraper/jobs    (GET)      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Job List        â”‚    â”‚  /api/youtube-scraper/jobs/[id](DELETE)  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  - Video Player    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          python-service.ts    â”‚                           â”‚   â”‚
â”‚  â”‚                                               â–¼                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚  getVideoInfoFromPython(url)    â†’ POST /info                    â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  downloadVideoFromPython(url)   â†’ POST /download                â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  checkPythonServiceHealth()     â†’ GET  /health                  â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           Vercel Blob Storage                             â”‚   â”‚
â”‚  â”‚        youtube-downloads/{userId}/{title}-{videoId}-{timestamp}.mp4       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â”‚ HTTPS
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   RAILWAY                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        Python FastAPI Service                              â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  server.py                                                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /health        â†’ Health check                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ POST /info          â†’ Get video metadata (yt-dlp extract_info)       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ POST /download      â†’ Download video & return file                   â”‚  â”‚
â”‚  â”‚  â””â”€â”€ POST /download-url  â†’ Get direct YouTube URL (may expire)            â”‚  â”‚
â”‚  â”‚                                                                            â”‚  â”‚
â”‚  â”‚  Dependencies: fastapi, uvicorn, yt-dlp                                   â”‚  â”‚
â”‚  â”‚  Environment: YOUTUBE_SERVICE_API_KEY                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â”‚ yt-dlp
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   YOUTUBE                                        â”‚
â”‚                        (Video hosting & streaming)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </pre>
        </div>

        <!-- Section 4: Data Flow -->
        <h2 id="flow">4. Data Flow & Sequence</h2>

        <h3>Download Flow Step-by-Step</h3>
        <ol class="steps">
            <li>
                <div class="step-content">
                    <div class="step-title">User pastes YouTube URL</div>
                    <div class="step-desc">User enters a YouTube URL in the KADABRA YouTube Scraper tool</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">Frontend calls /api/youtube-scraper/download</div>
                    <div class="step-desc">POST request with { url, quality: "best" }</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">API creates job in database</div>
                    <div class="step-desc">Creates YouTubeDownloadJob record with status "PENDING"</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">API calls Railway for video info</div>
                    <div class="step-desc">POST to Railway /info endpoint to get title, thumbnail, duration</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">API calls Railway to download video</div>
                    <div class="step-desc">POST to Railway /download endpoint - Railway downloads from YouTube</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">Railway returns video buffer</div>
                    <div class="step-desc">Video file returned as binary data in response body</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">API uploads to Vercel Blob</div>
                    <div class="step-desc">Stores video at youtube-downloads/{user}/{title}-{id}-{timestamp}.mp4</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">API updates job with blob URL</div>
                    <div class="step-desc">Status set to "COMPLETED", blobUrl saved to database</div>
                </div>
            </li>
            <li>
                <div class="step-content">
                    <div class="step-title">Frontend displays completed video</div>
                    <div class="step-desc">User can play, download, or send to Video Clipper</div>
                </div>
            </li>
        </ol>

        <div class="diagram">
            <div class="diagram-title">Sequence Diagram</div>
            <pre style="background: transparent; border: none; color: var(--text-secondary); font-size: 0.8rem;">
    Browser              Vercel API            Railway Python           YouTube
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚  POST /download     â”‚                      â”‚                      â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚                     â”‚  Create Job (DB)     â”‚                      â”‚
       â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                      â”‚
       â”‚                     â”‚         â”‚            â”‚                      â”‚
       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚                     â”‚  POST /info          â”‚                      â”‚
       â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚
       â”‚                     â”‚                      â”‚  extract_info()      â”‚
       â”‚                     â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                     â”‚                      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                     â”‚  { title, thumb }    â”‚                      â”‚
       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚                     â”‚  POST /download      â”‚                      â”‚
       â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                      â”‚
       â”‚                     â”‚                      â”‚  download video      â”‚
       â”‚                     â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
       â”‚                     â”‚                      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                     â”‚  video buffer (MP4)  â”‚                      â”‚
       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚                     â”‚  Upload to Blob      â”‚                      â”‚
       â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                      â”‚
       â”‚                     â”‚         â”‚            â”‚                      â”‚
       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚                     â”‚  Update Job (DB)     â”‚                      â”‚
       â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                      â”‚
       â”‚                     â”‚         â”‚            â”‚                      â”‚
       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
       â”‚  { job: completed } â”‚                      â”‚                      â”‚
       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                      â”‚                      â”‚
       â”‚                     â”‚                      â”‚                      â”‚
            </pre>
        </div>

        <!-- Section 5: Components -->
        <h2 id="components">5. Component Breakdown</h2>

        <h3>Frontend Components</h3>
        <div class="card">
            <div class="card-title">YouTubeScraperView</div>
            <p><code>apps/kadabra/lib/youtube-scraper/youtube-scraper-view.tsx</code></p>
            <p>Main UI component with:</p>
            <ul style="margin-left: 1.5rem; color: var(--text-secondary);">
                <li><strong>URL Input</strong> - Paste YouTube URL with validation</li>
                <li><strong>Job List</strong> - Shows all download jobs with status</li>
                <li><strong>Video Player</strong> - Full-screen modal player for completed videos</li>
                <li><strong>Actions</strong> - Play, Download, Send to Video Clipper, Delete</li>
            </ul>
        </div>

        <h3>API Routes</h3>
        <div class="grid-2">
            <div class="card">
                <div class="card-title">POST /api/youtube-scraper/info</div>
                <p>Gets video metadata without downloading. Used for preview.</p>
                <pre><code>Request:  { url: "https://youtube.com/watch?v=..." }
Response: { success: true, video: { title, thumbnail, duration, ... } }</code></pre>
            </div>

            <div class="card">
                <div class="card-title">POST /api/youtube-scraper/download</div>
                <p>Starts download process. Runs synchronously (waits for completion).</p>
                <pre><code>Request:  { url: "...", quality: "best" }
Response: { success: true, job: { id, status, blobUrl, ... } }</code></pre>
            </div>

            <div class="card">
                <div class="card-title">GET /api/youtube-scraper/jobs</div>
                <p>Lists all download jobs for the current user.</p>
                <pre><code>Response: { success: true, jobs: [...] }</code></pre>
            </div>

            <div class="card">
                <div class="card-title">DELETE /api/youtube-scraper/jobs/[id]</div>
                <p>Deletes a job and optionally its blob file.</p>
                <pre><code>Response: { success: true }</code></pre>
            </div>
        </div>

        <h3>Python Service Endpoints</h3>
        <div class="card">
            <p><strong>Base URL:</strong> <code>https://youtube-downloader-production-4222.up.railway.app</code></p>
            <table>
                <thead>
                    <tr>
                        <th>Endpoint</th>
                        <th>Method</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>/health</code></td>
                        <td>GET</td>
                        <td>Health check - returns { status: "ok" }</td>
                    </tr>
                    <tr>
                        <td><code>/info</code></td>
                        <td>POST</td>
                        <td>Get video info (title, formats, thumbnail, etc.)</td>
                    </tr>
                    <tr>
                        <td><code>/download</code></td>
                        <td>POST</td>
                        <td>Download video and return as file response</td>
                    </tr>
                    <tr>
                        <td><code>/download-url</code></td>
                        <td>POST</td>
                        <td>Get direct download URL (expires quickly)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section 6: File Structure -->
        <h2 id="files">6. File Structure</h2>

        <div class="card">
            <div class="file-tree">
                <div class="file-tree-item folder">ğŸ“ apps/kadabra/</div>
                <div class="file-tree-item folder indent-1">ğŸ“ app/api/youtube-scraper/</div>
                <div class="file-tree-item important indent-2">ğŸ“„ download/route.ts â€” Main download endpoint</div>
                <div class="file-tree-item file indent-2">ğŸ“„ info/route.ts â€” Video info endpoint</div>
                <div class="file-tree-item file indent-2">ğŸ“„ jobs/route.ts â€” List jobs endpoint</div>
                <div class="file-tree-item file indent-2">ğŸ“„ jobs/[id]/route.ts â€” Delete job endpoint</div>
                <div class="file-tree-item folder indent-1">ğŸ“ lib/youtube-scraper/</div>
                <div class="file-tree-item important indent-2">ğŸ“„ youtube-scraper-view.tsx â€” Main UI component</div>
                <div class="file-tree-item important indent-2">ğŸ“„ python-service.ts â€” Railway API client</div>
                <div class="file-tree-item file indent-2">ğŸ“„ types.ts â€” TypeScript interfaces</div>
                <br>
                <div class="file-tree-item folder">ğŸ“ services/youtube-downloader/</div>
                <div class="file-tree-item important indent-1">ğŸ“„ server.py â€” Python FastAPI server</div>
                <div class="file-tree-item file indent-1">ğŸ“„ requirements.txt â€” Python dependencies</div>
                <div class="file-tree-item file indent-1">ğŸ“„ Dockerfile â€” Container config for Railway</div>
                <div class="file-tree-item file indent-1">ğŸ“„ railway.toml â€” Railway configuration</div>
            </div>
        </div>

        <!-- Section 7: API Details -->
        <h2 id="api">7. API Endpoints in Detail</h2>

        <h3>Python Service - /download Endpoint</h3>
        <div class="card">
            <pre><code># Request
POST /download
Content-Type: application/json

{
    "url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
    "api_key": "yt-magi-secret-2024",
    "quality": "best",  // best, 720p, 480p, 360p
    "format": "mp4"     // mp4, webm, mp3
}

# Response
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="Video Title.mp4"

[binary video data]</code></pre>
        </div>

        <h3>Environment Variables</h3>
        <div class="card">
            <table>
                <thead>
                    <tr>
                        <th>Variable</th>
                        <th>Location</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>YOUTUBE_SERVICE_URL</code></td>
                        <td>Vercel</td>
                        <td>Railway service URL</td>
                    </tr>
                    <tr>
                        <td><code>YOUTUBE_SERVICE_API_KEY</code></td>
                        <td>Vercel & Railway</td>
                        <td>Shared API key for authentication</td>
                    </tr>
                    <tr>
                        <td><code>BLOB_READ_WRITE_TOKEN</code></td>
                        <td>Vercel</td>
                        <td>Vercel Blob storage token</td>
                    </tr>
                    <tr>
                        <td><code>PORT</code></td>
                        <td>Railway</td>
                        <td>Server port (default: 8080)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Section 8: Integration -->
        <h2 id="integration">8. Video Clipper Integration</h2>

        <p>Downloaded videos can be sent directly to the AI Video Clipper tool for automatic clip generation.</p>

        <div class="diagram">
            <div class="diagram-title">YouTube â†’ Video Clipper Flow</div>
            <div class="flow-container">
                <div class="flow-row">
                    <div class="flow-box frontend">
                        <div class="flow-box-label">YouTube Scraper</div>
                        <div class="flow-box-title">âœ‚ï¸ Click Scissors</div>
                    </div>
                    <span class="flow-arrow">â†’</span>
                    <div class="flow-box api">
                        <div class="flow-box-label">localStorage</div>
                        <div class="flow-box-title">Store Video Data</div>
                    </div>
                    <span class="flow-arrow">â†’</span>
                    <div class="flow-box frontend">
                        <div class="flow-box-label">Video Clipper</div>
                        <div class="flow-box-title">ğŸ¬ Load Video</div>
                    </div>
                </div>
            </div>
        </div>

        <h3>Integration Methods</h3>
        <div class="grid-2">
            <div class="card">
                <div class="card-title">Method 1: Send from YouTube Scraper</div>
                <p>After downloading a video, click the scissors icon to send it to Video Clipper.</p>
                <pre><code>// Stores in localStorage
localStorage.setItem('videoClipper_sourceVideo', JSON.stringify({
    url: job.blobUrl,
    title: job.videoInfo?.title,
    duration: job.videoInfo?.duration,
    thumbnail: job.videoInfo?.thumbnail,
}));
router.push('/admin/tools/video-clipper');</code></pre>
            </div>

            <div class="card">
                <div class="card-title">Method 2: Paste URL in Video Clipper</div>
                <p>Video Clipper has a "YouTube URL" tab that downloads videos directly.</p>
                <pre><code>// Uses same download API
const response = await fetch('/api/youtube-scraper/download', {
    method: 'POST',
    body: JSON.stringify({ url: youtubeUrl, quality: 'best' }),
});
// Then loads the blobUrl into the clipper</code></pre>
            </div>
        </div>

        <!-- Section 9: Deployment -->
        <h2 id="deployment">9. Deployment Guide</h2>

        <h3>Deploying to Railway (Python Service)</h3>
        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-title">Create Railway Project</div>
                <div class="timeline-desc">Go to railway.app â†’ New Project â†’ Deploy from GitHub repo</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-title">Set Environment Variables</div>
                <div class="timeline-desc">Add YOUTUBE_SERVICE_API_KEY in Railway settings</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-title">Configure Build</div>
                <div class="timeline-desc">Railway auto-detects Python, uses requirements.txt</div>
            </div>
            <div class="timeline-item success">
                <div class="timeline-title">Deploy</div>
                <div class="timeline-desc">Railway builds and deploys automatically on git push</div>
            </div>
        </div>

        <h3>Deploying to Vercel (Next.js)</h3>
        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-title">Connect Repository</div>
                <div class="timeline-desc">Vercel â†’ Import â†’ Select GitHub repo</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-title">Set Environment Variables</div>
                <div class="timeline-desc">Add YOUTUBE_SERVICE_URL, YOUTUBE_SERVICE_API_KEY, BLOB_READ_WRITE_TOKEN</div>
            </div>
            <div class="timeline-item">
                <div class="timeline-title">Configure Function Duration</div>
                <div class="timeline-desc">Set maxDuration: 300 (5 min) for download route</div>
            </div>
            <div class="timeline-item success">
                <div class="timeline-title">Deploy</div>
                <div class="timeline-desc">Push to main branch triggers automatic deployment</div>
            </div>
        </div>

        <h3>Key Configuration Files</h3>

        <div class="card">
            <div class="card-title">services/youtube-downloader/requirements.txt</div>
            <pre><code>fastapi==0.109.0
uvicorn==0.27.0
yt-dlp==2024.1.1
pydantic==2.5.3</code></pre>
        </div>

        <div class="card">
            <div class="card-title">services/youtube-downloader/Dockerfile</div>
            <pre><code>FROM python:3.11-slim

WORKDIR /app

# Install ffmpeg for video processing
RUN apt-get update && apt-get install -y ffmpeg && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY server.py .

CMD ["python", "server.py"]</code></pre>
        </div>

        <div class="card">
            <div class="card-title">services/youtube-downloader/railway.toml</div>
            <pre><code>[build]
builder = "dockerfile"

[deploy]
startCommand = "python server.py"
healthcheckPath = "/health"
healthcheckTimeout = 30</code></pre>
        </div>

        <footer>
            <p>ğŸ“š MagiManager YouTube Downloader Documentation</p>
            <p>Built with â¤ï¸ using Next.js, FastAPI, Railway, and Vercel</p>
        </footer>
    </div>
</body>
</html>
